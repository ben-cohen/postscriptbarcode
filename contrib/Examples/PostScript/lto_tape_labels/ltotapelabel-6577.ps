%!PS-Adobe-3.0
%%Creator: Matthew Newton
%%EndComments

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Edit the following settings to define the TLA and the
% number to start the sheet at (there are 33 labels per
% sheet).
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

/prefix (MCN) def
/suffix (L4) def
/number 1 def
/bordercolour [ 0.0 0.8 1 ] def

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% There should be no need to edit the code below...
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% -------8<--------- START OF BWIPP RESOURCE DEFINITIONS ---------8<-------

% These PS named resource definitions are from Barcode Writer in Pure
% PostScript. https://bwipp.terryburton.co.uk
%
% If BWIPP is already available to the named resource machinery of the PS 
% VM then these definitons can be omitted.

%%BeginResource: Category uk.co.terryburton.bwipp 0.0 0 0 0

% Barcode Writer in Pure PostScript
% https://bwipp.terryburton.co.uk
%
% Copyright (c) 2004-2009 Terry Burton

%%BeginData:          6 ASCII Lines
currentfile /ASCII85Decode filter cvx exec
P1OerF_-`n01TSk      ATDKp  010/i  AS5q%  H'  6mE      30Ia,!      KmJH23J
i?3%mj@F*(i.@qA        VbE  +L\A@  :O(aA  79  M!@         <ls         ?E+P
2W06M%_@rEuAATD  g:@Wc  ^5  Df.1:   GA2#  8P  !1N  d@<?'  nDf  U+GA7  ]@eD
Imj"F)Q2A@qCgGP  2?~>
% Category/uk.co.terryburton.bwipp 0.0 0
%%EndData
%%EndResource

%%BeginResource: uk.co.terryburton.bwipp renlinear 0.0 0 0 0

% Barcode Writer in Pure PostScript
% https://bwipp.terryburton.co.uk
%
% Copyright (c) 2004-2009 Terry Burton

%%BeginData:         70 ASCII Lines
currentfile /ASCII85Decode filter cvx exec
06:]HE+*6lBl7RH      \pKT_  @s)g4  ASuU/  @:  O(e      DJ()6E      ckq9F(K
H4@:O(eDJ+B\</:        R<2  3JD%E  b0-)B  l7  KjE         dNT         VOu8
C304Am6F-8_M1G<  fYF!+  [0  ?'6us   @VBg  *>  9I4  71G<3  HF!  +[0?'  6usF
EhmM>9I471G<3GE  as$(D  fUj  AF`    )83F  HS  F5B  l7EsF_  #'  *AU&;>  Amo
LsAWei&FCf]=@rH  1%EfL  <GD  KBB  2 Ou"  b5A  U&<  A@;KXj  DN  4mCDKB  B2O
u"b5AU&<B@;KXjD  N4mCD  KBB  2Ou "b 5AU  &</  Df0  ZW#=EE  PE  bT**Ou  "b5
AU&<<BmO?H$Bd1u        FCf]  =G] .2  +F  (KH  L!0  T,k    FCf  ]=H    #I;,
F(KHL!0T,kFCf]=         B45b  #  L]  ES  o04  A[=        FCf]        =NW>4
u04Jj?A7]dkDes?  4NWjQC  F(K  H  V1G <3 G@r#  ^tD  for.@rH1%E  fL<GDKBB2Ou
"b*DJO<4Eb/ZiME  VoGRZ]  H[G  A 1T0B    SZYO  1G<  3GEcPT1BlA  e.Ou"b4E+*6
fEaa'(DhnFW1G<f  _Dg,Z/  Eb&a   %+D,    %uF(  LLj  04Jj?A7]dt  AS-%?$Bd1u@
W-9tATDg*B4uCC$  Bd1u@  W-9tA   TDm2    E/4O  X1G  <3UEb&a%@W  -@1Df(:2Ou"
b#DfTB"Ed)5.FD-         Or!!!   "^1G<  B`@<,  n&B  PDR"F)YPtA  KYSnCia0N1G
<B`@<,mpAS-%'Df       ^^7Ou"b  (F^]<$  Ch74#  H#R  \CL]ESo05#  E9Eb'3)B4uC
+Df^^7Ou"b(F^]<$EbT0"FEqhDF,0gZ1G<B`@<,n&Bk2=!L^'"u05#E9Eb&ipBkM+$L^0)!@<-
"%H]g15P"BS2FF00,I?I/T@UX:eDes?4+C\c"@rH1%Efr#;1G<i]G][G6Ci=>:FCf]=@rH1%Ef
r#;1G<i]G]\1=Ch[O"+EV1>FEh51BkM=H/WqnCFCf]=H!tN'B5Si6AU&<B@;KXjDNZT71G<i]G
][P9DKI"CAU&</Df0Z[/WqnCFCf]=F(or3+EV1>FE;/BAWe^01G<i]G]\1KAnH*qF<G[:G]\1K
AnH*qFHS;?1G<i]G]\4LAnH*qF<G[:G]\4LAnH*qFHS;?1G<i]G][S,E-!.DAU&<0@;p:N09S+
E@;L%-AU&;>@;L%-AU&<[/WqnC@W-9tATD:!Ci=>:@W-9tATD:!Ci=?W/WqnC@UWb^B6%p5DId
6qCi=>:@UWb^B6%p5DId6qCi=?W/WqnCBl7^-E,oMuA0>T(CNFH8ART,409S+EGA1T0BHVM5A9
;LJ09S+E@UX:t@<?4%+C\c"Eaa'(Diuc:1G<fg@:Nkh@<?4%+EML1@qB[hFD5ZV09S+E@W-9tA
TDTuAoo/)DfTB"Ebo<!FHS;?1G<3UEb&a%EbT0"F<G%2Eb&a%EbT0"FHS;?1G<3UEb&a%FDl+@
@W-9tATDm2E0;l;1G<3UEb&a%@W-@1Df$V+DfTB"Eais/FDl#Z09S+E@W-9tATE!/A9;K-@W-9
tATE!/A9;LJ09S+EB6@X'A8GghFDu/>+D5h*Eb&utAor!1F-82>1G<B`@<,mpAS-%0E,Te?B6@
X'A8GghFEqhDF-82>1G<B`@<,n!BkM+$E,Te?B6@X'A9)BsBQS33F-82>1G<B`@<,n!BkM+$H#
R\C+D5h*Eb'3)B4uC4E,Tf\09S+EB6@X'A9V`uFD)e0F^]<$GA1T0BTb$31G<B`@<,mlASGdjF
<G4=@<,mlASGdjFHS;?1G<3GEcW@E@WR]AL]NY>L]W`;OpR:-06i?S!!!"^1G<TRG\Dm5Ou%mo
L]MR+F-:!g!KmJ>!g6H;!g7AU!g9O0056S5Ou$g.!g7;S!0TKl04Z2H@WNZ+P"T7mEcPT1BlB/
N@UX:t@<?4%P,X6<Oo^_%05)J;BQG;1L]W`;P"UU%P&-:;04Q,8L]W_tG`i)j1G="r@UaC$Bnu
hR;Na\/8<ReP1G<qpA0>T(CNFH8ART,4WKK&H@<-E3BnuhR;Hk8W+CcO>+Enr6P'CX_D..[&P#
-KYD..[&+D?ooI?IQXHS8nPF(025Bp),1E+*6fEaa'(Dj"pXE+*6fEaa'(Dj%)U!KmJH1OYEd0
6eUa+CpW9Ou%NL8<Q`2.$C]VBk2=!L]ETTHZs17FD-J$P&,B+2M_BsMg^af06:]H@;^@#Des?4
HS8fFH"1c/DfV")Ou$NaH"1c/DfV"ML^'#*H]A@o+<VdL+<Wk(#a2$I)3Qt8!F]kk@rH1%Eft^
216OkKL&h7:2LU`[P+@#a<+0Zi@rH1%Efsmf#a.>tNX@lk+<VdL+<VdjL^K<AOr9EBL]Lq%H"1
c/DfV"dOtr1bH\MP#Ou@`O8Wo9cP#Qjm%[&W2DdmX*A7]dtAS-%IDIRO)A7]djDfg)>D3Ae"CN
pt2DfTB"Ebo<!FHQZ6DfTB"EcPl,BQTC<L]ETlL]D:#G\A4/DfTB"Eais/FDl#Z!FftfA7]e'D
fCj?P(e-'@W-9tATDTuAos1:@W-9tATDg*B4uCM!Kq>V!0W%l!,Z.hBHUc&Eb&a%@W-@1Df(X<
@W-9tATDm2E0:6bDN]^:(1L]^CM.[+F`(`"Des?4NWjQCF(KHVD0qF@@UWb^B6%p5DId6qCi=>
:F(KH%DL#`1Ci=?W6BY&kP#QL9Dg,Z/Eb&a%H]h-5DfTB"Eas$(DfUjAF`)83FHUKf@W-9tATD
:!Ci=>:F(KH%DL#`1Ci=?BP#Pn/Eb&a%GA1T0BTejJVijc&P#RT>L]EU+@UX:eDes?4NWjQCF(
KHVD0o`#Eas$(DfQtAATV?uH"1c/DfU8h<+99VF*i7^P"CgTP+.VML]ET%P(f'sI?I0b9lsrkF
CT6*DfUjAF`)83FHUKfFCf]=@rH1%EZfF7FCB'4@rH1%Eda*MBl7EsF_#'*AU&<D+EV1>FEh51
BkM=D"a+^(ATX(uFCf]=H!tN'B5W_5F`)83FHSeM"CZ+gFCf]=NW>5*Op$+bF,0gZ1G<@#!0T-
[G]\:ZI?I0X!g4FBP&6@GAs."oEdNTDOr5ooP!5$b04pA2Ou&7bP!bBrP)PQhI=%-"P')29<K_
-\TRDtpI=$'IG][P9DKM%/FCf]=F(or3P)PQh@;L%-AU&<W!0TKl06DG\+Bot1G]\:g!0U!%I?
I0MP"ArB1G<ikFE/LGG]]*XP,4<tL]E53FEhnj@Yb&JWI'dfFEhnj5*AQ\F*)GY",Hu@LQZn1P
":"J06D8WEZee,FED)=FHSG.P#ZUFFE3ORL]ET$H\_ZMH]h-eDhnCL!0V,X!AJ+oCia0N&X%3k
"Gd)ALQZeCFcpm19p-VP:gn'UFB!O)AWgGJOruDS@;0V$<-`FoP"UT4P!+5?AmoLsAUT_AOruD
VFE2;8AQNSVFD-hFOp$,p+>6Z8Ec5`)=(u2eBTc#E!g5Ht!0TO/+>63&DKJT]FE2)?P"UrsOuS
V@P!5$gP&-9^F)c5BOo]uo<.0p006CcMFCB6#ASuUQ5*@]TFCf]=GA1T0BHVD<FE3PAP'(kfFE
3ORL]N[<FCf]=B45b#P&-9^Ou"b5AU&<AE,Te?FCf]=G].2+F(KG9GT_*>G]\.DA9;LJWJCV=2
Ne*(1N[2QFEh51BkM=D"DhX]FHSe606CcMFEhbCF!,R9G]\1KAnH*qFHSG.P#QO7G]\1=Ch[O"
NWjH;B4uCM4aSi(AU&<AE,Te?GT_*>G]\1KAnH*qFHWVFAU&<@Bk2=!P,XU#I?IQOAU&<A@;KX
jDN4s?AnGjjAos2!HS9JPG]\1LDf[%CAU&<@Bk2=!+EV1>FEh_9AohO*Oo^_`Ou%NL<-2\rFEh
51BkM=D#]F<eEbT0"FHSe606CcMFEhbCF!,]MFCf]=G].2+F(KHV!Ko6eP#QO7G]\1=Ch[O"NX
'<AF*),.H'1=4AU&<@Bk2=!+F'&]Op$+bFCf]=G]7SBL]ESo06CcMFD#$$F!,]MFCf]=GA1T0B
Tf?:F*)Gc@Yb&JWKK0&1OYEc06CcMFEqhDF!,R9G]\4LAnH*qF<G[:G][A8@qBP"Oo^@>Oo^_`
Ou%2kG]\4>Ch[O"NWij#Dg#]T4aSi(AU&<BE,Te?FCf]=H#I;,F(KG9D..[&Oo^@>Oo^_%I?IQ
OAU&<B@;KXjDN4p2ASuU$EfrS406CcMFEqhDF!,R9G]\4LAnH*qF<GF/G\A4AAU&<*F(8d!FHW
VZ!g5I)!Ko6eP#QO7G]\1LDf[%CAU&<BE,Tf\CNO-4FD#$$F,0g<F*)Gc$@S(;I?IQBF^]<$GA
(]4ATMg!@qC"E5<o2KP+-*,@<,mpAS-%'Df^^7P&5Q/DeF3$Eb&utAor!1F-:ERF^]<$GA1T0B
T`C/F^]<$Ch74#H#R\C+D5h*Eb'B.A9;L@!g5I)!Kq52F^]<$GA1T0BTd7GF^]<$BOtmjBQT(0
OuAJWB6@X'A9V`uFD)e0F^]<$BOtmjBQT(0OuAJWP,E_k<+g>^Eb'3)B4uC+Df^^7P&5Q/DeF3
$Eb'3)B4uC+Df[%GOo]3<@<,n&Bk2=!P,W):@<,n!BkM+$H#R\C+D5h*Eb&ipBkM+$L]W_tOo^
_]B6@X'A9V`uFD)e0F^]<$BOtmjBQT(0OuAJWB6@X'A9V`uFD-hTB6@X'A8#OgB4uCCrfT1&Kp
&?^P#Qjm<0Bt=3IR&#Ou"b3ASu<uDIm6sOuSV806M%_@rEuAATDg:@Wc^5Df.1:GA2#8+Co%qB
l7L&ATMd4Ear[DFcna<F(KH4@:O(eDJ,-DH]iMmATVm"@r#drB75qB~>
% uk.co.terryburton.bwipp/renlinear 0.0 0
%%EndData
%%EndResource

%%BeginResource: uk.co.terryburton.bwipp code39 0.0 0 0 0

% Barcode Writer in Pure PostScript
% https://bwipp.terryburton.co.uk
%
% Copyright (c) 2004-2009 Terry Burton

%%BeginData:         47 ASCII Lines
currentfile /ASCII85Decode filter cvx exec
06:]HE+*6lBl7RH      \pKT_  @s)g4  ASuU/  @:  O(e      DJ()6E      ckq9F(K
H4@:O(eDJ+B\</:        R<2  3KpPE  b0-)B  l7  KjE         frC         8F_`
U>D_?-CEcQG7F`M  SBDD#  CB  BlJ$S   g6-]  D%  524  0A7[P  WH\  `B!23  JD%D
fBf4Df0WZ5*@]T@  UX:eD  e*F  B5*    @]TA  8c  @-A  9)+&+D  ,%  uF(LLj  055
<6Cis9"@q]F`CER  4tCia  0N1  G<H  [ @r-  9uA  TVL  .F<G1(  Ci  a0N1G<  H[@
r-9uARfCb@r#drF  Cf]=+  D,%  uF( LL j05  ,'1  ATM  s%EcW@  8@  ;L!rOu  "b5
AU&</Df0ZZa-&53        FCf]  =F( or  3L  ^K;  $06  CcM    FEq  e:A    ohO*
M#!2i05+p2B4uCC         !Ko6  W  E-  ,f  4DK  CuE        06;5        UBl7R
*H#R>X4aVtcOu8C  3DfBf4  Df0  W  CP, i2 'Cia  0N4  aW>WI?IQm3  0Ia6V33Qn!B
lU*FE2M8P!+/T/W  r;\Fcn  qO1  O XV5/    Tc#U  AWe  itP#ZpnAWe  *t3A5;iFD5Z
2F-8_M1OYEcDfBf  4Df0WC  Ou%N   L8M>    0sG]  [P9  DKI"CAU&</  Df0Z[/WqnCF
Cf]=F(or3+EV1>F  E;/BA  We^01   G<i]    G]\4  LAn  H*qF<G[:G]  \4LAnH*qFHS
;?1G<EQBkM+$+D>         >#B4u   CM09S  +EASu  "!+  Bsj50ekC=1  GL[?0en[q1G
LU?0ekC;1GOms0e       kI?0ekC  ;1GOms  1GL[A  0ek  C;0en[q0ek  C=1GLU=1GOm
s1GLU?1GLU=0en[q0ekI?1GLU=0en[q0ekC=0ekI=1GOms1GLU?0ekI=0en[q0ekI?0ekI=0en
[q1GLU=0f(O=1GOms0ekI=0f(O=1GOms1GL[?0f(O=0en[q0ekC;1G^a?1GOms1GLU=1G^a?0e
n[q0ekI=1G^a?0en[q0ekC;0f(U?1GOms1GLU=0f(U?0en[q0ekI=0f(U?0en[q0ekC;1G^gA0
en[q1GLU=0ekC=1GOms0ekI=0ekC=1GOms1GL[?0ekC=0en[q0ekC;1GLU?1GOms1GLU=1GLU?
0en[q0ekI=1GLU?0en[q0ekC;0ekI?1GOms1GLU=0ekI?0en[q0ekI=0ekI?0en[q0ekC;1GL[
A0en[q1G^a?0ekC;1GOms0f(U?0ekC;1GOms1G^gA0ekC;0en[q0f(O=1GLU=1GOms1G^a?1GL
U=0en[q0f(U?1GLU=0en[q0f(O=0ekI=1GOms1G^a?0ekI=0en[q0f(U?0ekI=0en[q0f(O?0f
(O=0en[q0f(O?0ekC=0en[q0f(O=0f(O?0en[q0ekC=0f(O?0en[q0f(O=1GL[?0elss1G<3GE
arckEc[6l0JP==1c70M3&s8k6UX@47n?3D92&&T:Jand;cHat='/U//M8.k0.S=uOu"b#@<-0q
DBNCsEas#uAWgMc1ML`:Cis9"@q]F`CO7^U@WNZ$@<-0qDMSX_Cks-q!Ks:B1G<ipF<G%$Ebo<
)L]`e@OpR:-I=!Vg@WNZ$@<-0qDMSX_Ckrdg!Ks:B1G<ipF<G%$Ebo<)L]W_?OpR:-I?IS`@q]
F`CNFW8L]ESoF(03H!+g%XF,2?099OR6Bk1drFCB32P&PbiG]\`A>E/_6L]DO.G]\4LAnH*qF<
G[:G][P9DKI"CAU&<<BmO>5?'9G\HZXLSL]CY>!/LVsAU&<BDe<U&ATT&:AU&</Df0Y>FCf]=F
(or3+C1.TI?ITd!/LYb@<-0qDMS=VWI$:4P!5$b@UX:eDe*E%BnueQ9O_FN@q]:kF-8_MNKSFI
@P;G5A9a8$Ou&8DP'&EhDIXf#DI[`1Bl7I+P"UroF(025Bo!+ZCkrF]!G-.YP'M.oF<G:R!KmI
f+C\c"@rGmh+DHW4P"]SG!KmJ>&<^jOAU&<BDe<U&ATT&:AU&</Df0Y>FCf]=F(or3+C1.T04S
[,@r$..D'3>%ARfLsF_r78DIe!T!Ko6eP"9;)@r-9uARfCb@r$EE@q]F`CNFW8+Cf(r@r$..D2
9^*C6CAo@WNZ$@<-0qDMSX_CkrF]!G-.YF!+t+ARfLsF`!:7P'LbZ@r-9uARfCb@r#drFCf]=H
Q[ETF<G%$Ebo<)L]NY>>9IB`EarckEcW@5BOt[hF*2>U!Kp,c@<-0qDMS=V!Jh;MCij65FEqe:
AohO*+EV1>FCoH/F<G[:G]\"@H=\4)P'DD%FEhmM@UX:nAT!;)Oo\dI!+KAWCh7L?!KmJ>&<^j
OAU&<BDe<U&ATT&:AU&</Df0Y>FCf]=F(or3+C1.TI?ITO@WNZ$@<-0qDMSX_Ckrdg!G-.YF,2
?099OR6Bk1drFCB32P&PbiG]Y';@<-0qDMS@W!F(Qb.Ulh,Ch7L?!g3S?&<^jOAU&<BDe<U&AT
T&:AU&</Df0Y>FCf]=F(or3+C1.TI=$'\F<G%$Ebo<)L]W_?>E/\m@<-0qDMS@W!Jh;MCij65F
Eqe:AohO*+EV1>FCoH/F<G[:G]\"@H=\4)P'DD<<IK48@WNZ$@<-0qDMSX_CkrF]!G-.YF,2?0
99OR6Bk1drFCB32P&PbiG]Y';@<-0qDMS=V!F(Qb.Ulh,Ch7L?!KmJ>&<^jOAU&<BDe<U&ATT&
:AU&</Df0Y>FCf]=F(or3+C1.TI=$'\F<G%$Ebo<)L]NY>>E/\m@<-0qDMS=V!Jh;MCij65FEq
e:AohO*+EV1>FCoH/F<G[:G]\"@H=\4)P'DD<<IL$14?P9;ASs.SEb0-)Bl7KjE\DKCF!+[0F(
03;LbP!kI?I0-04JU9+Bot0@WR]AL]NY>L]W`;HY?u)B4uC8P(R$n@UaC$>9IurF-:!g!KmJ>!
g6H.L]DjdK3]U6DI[L*A7]joG]\9cFEhmMFEhnUP#O)QE-*4@E-,f4DK?pa4s4BSDKKE0@<[lR
0/%?WDJX$)ARTVB<0B7iOq*X204Sp2AMZ?030If*F_`U>D_?-CEcQG7F`MSBDD#CBBlJ#6A7]@
eDImj"F)Q2A@qCgGOuY1:ATVm"@r#drB9KiQP'(hWFDtYuCM@[!I?IP~>
% uk.co.terryburton.bwipp/code39 0.0 0
%%EndData
%%EndResource

% -------8<---------- END OF BWIPP RESOURCE DEFINITIONS ----------8<-------

/LTOlabel {

  20 dict begin

  dup type /arraytype eq {
    /bordercolour exch def
    exch
  } if
  /code exch def

  /mm { 25.4 div } def
  /in { } def

  /topwid 67 mm def  % width of top bc
  /botwid 37 mm def  % width of bottom bc
  /vgap 1 mm def     % horiz gap between codes
  /tophi 7 mm def    % height of bottom code
  /bothi 7 mm def    % height of bottom code
  /bottom 3 mm def   % bottom gap
  /left 6 mm def
  /width 78 mm def
  /height 16.5 mm def

  /message (This edge of label toward hub of tape) def
  /messageypos 2.5 def
  /messageptsize 5 def

  /textsize 9 def
  /letterwidth 10 def
  /rectadjust 2 def

  /colours <<
    /0 [ 1 0 0 ]
    /1 [ 1 1 0 ]
    /2 [ 0.5 1 0 ]
    /3 [ 0.4 0.7 0.7 ]
    /4 [ 0.5 0.5 0.5 ]
    /5 [ 1 0.5 0 ]
    /6 [ 1 0.5 1 ]
    /7 [ 0 0.5 0 ]
    /8 [ 1 0.75 0 ]
    /9 [ 0.5 0 0.7 ]
  >> def

  /c39 code (includecheck dontdraw) /code39 /uk.co.terryburton.bwipp findresource exec def
  /barwid c39 (sbs) get 0 exch {add} forall 72 div def

  % set clipping to outside of label
  0 0 width 72 mul height 72 mul rectclip

  % draw the box around the label
  gsave
    0.2 setlinewidth
    0.6 setgray
    newpath
    0 0 moveto
    0 height 72 mul lineto
    width 72 mul height 72 mul lineto
    width 72 mul 0 lineto
    0 0 lineto
    stroke
  grestore
 
  % draw the top barcode
  gsave
    left 72 mul
    bottom 72 mul bothi 72 mul add vgap 72 mul add
    moveto
    topwid barwid div tophi scale
    c39 dup (ren) get exec
  grestore

  % draw the bottom barcode
  gsave
    left 72 mul botwid 72 mul add
    bottom 72 mul
    moveto 
    botwid barwid div neg bothi scale
    c39 dup (ren) get exec
  grestore

  % draw the info text
  gsave
    /Helvetica findfont
    messageptsize scalefont setfont
    newpath
    width 72 mul 2 div message stringwidth pop 2 div sub
    messageypos moveto
    message show
  grestore
 
  % create the text
  %
  % set starting X position: first get the right X pos of the top
  % barcode:
  left 72 mul topwid 72 mul add
  % and then subtract the length of our bit of text:
  code length 2 sub letterwidth mul sub
  % and adust slightly for the border. hack alert.
  3 sub
  % now get the y position (half way up the bottom barcode):
  bothi 72 mul 2 div bottom 72 mul add
  % background colour
  2 copy
  userdict /bordercolour known {
    gsave
    bordercolour aload pop setrgbcolor
    2 copy
    % set x position of outer (semi-) border
    exch letterwidth sub rectadjust add exch
    % and y position
    bothi 72 mul 2 div sub
    code length 2 sub letterwidth mul
    bothi 72 mul rectfill
    grestore
  } if
  newpath
  moveto
    /Helvetica-Bold findfont
    textsize scalefont setfont
    % now draw each letter in turn, except the last two letters
    0 1 code length 3 sub {
      % get the letter
      code exch 1 getinterval
      % do we need to draw a coloured box behind this character?
      dup cvn colours exch known {
        gsave
          dup cvn colours exch get aload pop setrgbcolor
          % get bottom left hand position for bg rectangle
          currentpoint bothi 72 mul 2 div sub
          % adjust x-value for position of letter
          exch letterwidth sub rectadjust add exch
          % set rectangle width/height and draw
          letterwidth bothi 72 mul rectfill
        grestore
      } if
      % find its width / 2
      dup stringwidth pop 2 div
      % move to the right place, rotate and draw
      gsave
        90 rotate
        neg 0 rmoveto
        show
      grestore
      % shift to the next letter
      letterwidth 0 rmoveto
    } for
    % draw the last two letters
    code dup length 2 sub 2 getinterval
    dup stringwidth pop 2 div
    gsave
      90 rotate
      neg 0 rmoveto
      show
    grestore
    % and the border
  stroke 
  gsave
    userdict /bordercolour known {
      bordercolour aload pop setrgbcolor
    } if
    % set x position of outer (semi-) border
    exch letterwidth sub rectadjust add exch
    % and y position
    bothi 72 mul 2 div sub
    newpath
    1 setlinewidth
    code length 1 sub letterwidth mul
    bothi 72 mul rectstroke
  grestore

  end

} bind def

<< /PageSize [ 595 841 ] /ImagingBBox null >> setpagedevice

/gridx 3 def
/gridy 11 def
/xstep 78   72 mul 25.4 div def
/ystep 16.5 72 mul 25.4 div def
/leftborder 36 def % 0.5 in
/bottomborder 36 def % 0.5 in

% we want landscape pages
0 841 translate
-90 rotate

0 1 gridx 1 sub {
  /x exch def
  0 1 gridy 1 sub {
   /y exch def
   % roll number around after 999, back to 0
   number 999 gt {
     /number 0 def
   } if

   x xstep mul leftborder add
   %gridy y sub 1 sub ystep mul bottomborder add
   y ystep mul bottomborder add
   gsave
     translate
     % create new string to hold the code
     /s suffix length prefix length 3 add add string def
     % set all characters to "0" to start with
     0 1 s length 1 sub {
       s exch (0) 0 get put
     } for
     % copy prefix in to it
     s 0 prefix putinterval
     % copy suffix in to it
     s s length suffix length sub suffix putinterval
     % put the number in
     /numstring number 3 string cvs def
     s prefix length 3 numstring length sub add numstring  putinterval
     s LTOlabel
     /number number 1 add def
   grestore
  } for
} for

showpage

